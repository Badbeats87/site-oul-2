<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pricing Policy Editor - Vinyl Catalog Admin</title>
    <link rel="stylesheet" href="../../styles/design-system.css?v=20251205" />
    <link rel="stylesheet" href="../../styles/admin.css?v=20251205" />
    <link rel="stylesheet" href="../../styles/pricing-editor.css?v=20251205" />
  </head>
  <body class="admin-body admin-body--topnav">
    <header class="admin-topbar">
      <div class="admin-topbar__brand">
        <span class="admin-sidebar__logo">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="#fff"
            stroke-width="1.5"
            width="26"
            height="26"
            aria-hidden="true"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <circle cx="12" cy="12" r="6"></circle>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </span>
        <div>
          <div class="admin-sidebar__title">Vinyl Catalog</div>
          <div class="admin-sidebar__subtitle">Operations Console</div>
        </div>
      </div>

      <form class="admin-topbar__search" role="search">
        <svg
          viewBox="0 0 24 24"
          width="16"
          height="16"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          aria-hidden="true"
        >
          <circle cx="11" cy="11" r="7"></circle>
          <line x1="16.5" y1="16.5" x2="21" y2="21"></line>
        </svg>
        <input
          type="search"
          placeholder="Search pricing policies‚Ä¶"
          aria-label="Search admin data"
        />
        <button type="submit" aria-label="Submit search">
          <svg
            viewBox="0 0 24 24"
            width="14"
            height="14"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </button>
      </form>

      <div class="admin-topbar__actions">
        <button
          class="admin-icon-button"
          type="button"
          aria-label="View notifications"
        >
          <svg
            viewBox="0 0 24 24"
            width="16"
            height="16"
            fill="none"
            stroke="currentColor"
            stroke-width="1.7"
          >
            <path d="M18 8a6 6 0 10-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 01-3.46 0"></path>
          </svg>
        </button>
        <div class="admin-topbar__user">
          <div class="admin-avatar" aria-hidden="true">AM</div>
          <div class="admin-header__user-meta">
            <span class="eyebrow" style="color: rgba(243, 244, 246, 0.7)"
              >Pricing Owner</span
            >
            <strong>Alex Mercer</strong>
            <span>Policy edits lock at 8pm</span>
          </div>
        </div>
      </div>

      <button
        class="button button--ghost button--sm admin-topbar__toggle"
        type="button"
        data-nav-toggle
        aria-expanded="false"
      >
        Menu
      </button>
    </header>

    <nav class="admin-subnav" aria-label="Admin navigation">
      <div class="admin-topbar__nav admin-subnav__links" id="admin-topbar-nav">
        <a class="admin-nav__link" href="index.html">Dashboard</a>
        <a class="admin-nav__link" href="submission.html">Submissions</a>
        <a class="admin-nav__link" href="inventory.html">Inventory</a>
        <a
          class="admin-nav__link admin-nav__link--active"
          href="pricing-editor.html"
          >Pricing</a
        >
      </div>
    </nav>

    <div class="admin-announcement">
      Change control: two approvals required for buy/sell adjustments above 5%.
    </div>

    <main class="admin-main admin-main--wide">
      <header class="admin-toolbar">
        <div class="admin-toolbar__context">
          <p class="eyebrow">Pricing intelligence</p>
          <h1>Policy Editor</h1>
          <p>
            Configure formulas powering buy offers and list prices across every
            marketplace.
          </p>
        </div>
        <div class="admin-toolbar__actions">
          <button class="button button--secondary button--sm" type="button">
            Preview
          </button>
          <button class="button button--primary button--sm" type="button">
            Save Draft
          </button>
          <button
            class="button button--danger button--sm"
            type="button"
            data-logout-btn
          >
            Logout
          </button>
        </div>
      </header>

      <section class="admin-hero">
        <div>
          <p class="eyebrow">Policy health</p>
          <h2>Standard Global</h2>
          <p>
            Feeds 78% of intake decisions. Local overrides inherit these
            guardrails.
          </p>
          <div class="admin-hero__meta">
            <div class="admin-hero__stat">
              <span>Overrides</span>
              <strong>6 active</strong>
            </div>
            <div class="admin-hero__stat">
              <span>Last Updated</span>
              <strong>Today ¬∑ 9:12AM</strong>
            </div>
            <div class="admin-hero__stat">
              <span>Guardrail Checks</span>
              <strong>All green</strong>
            </div>
          </div>
        </div>
        <div class="admin-hero__card">
          <p class="eyebrow">Change control</p>
          <h3>Remember dual approval</h3>
          <p>
            Any multiplier adjustment above 5% requires sign-off from Finance
            &amp; Ops.
          </p>
          <div class="admin-hero__badges">
            <span class="admin-hero__badge">Buy % ¬∑ 55%</span>
            <span class="admin-hero__badge">Sell % ¬∑ 125%</span>
            <span class="admin-hero__badge">Markdown active</span>
          </div>
        </div>
      </section>

      <section class="policy-section">
        <h2 class="section-title">Policy Information</h2>

        <div class="form-row">
          <div class="form-group">
            <label>Policy Name</label>
            <input
              type="text"
              value="Standard Global"
              placeholder="e.g., Classic Rock Premium"
            />
          </div>
          <div class="form-group">
            <label>Description</label>
            <input type="text" placeholder="Optional notes about this policy" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Scope</label>
            <select>
              <option selected>All Releases (Global)</option>
              <option>By Genre</option>
              <option>By Label</option>
              <option>By Acquisition Channel</option>
            </select>
          </div>
          <div class="form-group">
            <label>Status</label>
            <select>
              <option selected>Active</option>
              <option>Draft</option>
              <option>Archived</option>
            </select>
          </div>
        </div>
      </section>

      <section class="policy-section">
        <h2 class="section-title">Condition Grade Adjustments</h2>
        <p class="section-subtitle">
          Define percentage adjustments for each condition grade. These are
          applied multiplicatively to base prices.
        </p>

        <div class="condition-table-wrapper">
          <h3 class="subsection-title">Media Condition Curve</h3>
          <table class="table condition-table">
            <thead>
              <tr>
                <th>Grade</th>
                <th>Description</th>
                <th style="width: 120px">Adjustment %</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Mint (M)</strong></td>
                <td>Perfect, unplayed condition</td>
                <td>
                  <input type="number" value="120" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Near Mint (NM)</strong></td>
                <td>Minimal signs of wear</td>
                <td>
                  <input type="number" value="100" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Very Good Plus (VG+)</strong></td>
                <td>Light wear, plays perfectly</td>
                <td>
                  <input type="number" value="75" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Very Good (VG)</strong></td>
                <td>Moderate wear visible</td>
                <td>
                  <input type="number" value="60" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Very Good Minus (VG-)</strong></td>
                <td>Significant wear but playable</td>
                <td>
                  <input type="number" value="45" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Good (G)</strong></td>
                <td>Heavy wear, may affect playback</td>
                <td>
                  <input type="number" value="25" class="input-percentage" /> %
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="condition-table-wrapper">
          <h3 class="subsection-title">Sleeve Condition Curve</h3>
          <table class="table condition-table">
            <thead>
              <tr>
                <th>Grade</th>
                <th>Description</th>
                <th style="width: 120px">Adjustment %</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Mint (M)</strong></td>
                <td>Perfect, no creases or wear</td>
                <td>
                  <input type="number" value="110" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Near Mint (NM)</strong></td>
                <td>Minimal storage wear only</td>
                <td>
                  <input type="number" value="100" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Very Good Plus (VG+)</strong></td>
                <td>Minor creases or edge wear</td>
                <td>
                  <input type="number" value="75" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Very Good (VG)</strong></td>
                <td>Obvious creases, fading</td>
                <td>
                  <input type="number" value="50" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Very Good Minus (VG-)</strong></td>
                <td>Heavy creasing, stains</td>
                <td>
                  <input type="number" value="35" class="input-percentage" /> %
                </td>
              </tr>
              <tr>
                <td><strong>Good (G)</strong></td>
                <td>Severe damage, writing, water</td>
                <td>
                  <input type="number" value="15" class="input-percentage" /> %
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Media Weight</label>
            <p class="input-help">How much media condition affects pricing</p>
            <div class="input-with-unit">
              <input type="number" value="60" min="0" max="100" />
              <span class="unit">%</span>
            </div>
          </div>
          <div class="form-group">
            <label>Sleeve Weight</label>
            <p class="input-help">How much sleeve condition affects pricing</p>
            <div class="input-with-unit">
              <input type="number" value="40" min="0" max="100" />
              <span class="unit">%</span>
            </div>
          </div>
        </div>
      </section>

      <section class="policy-section">
        <h2 class="section-title">Buy (Offer) Formula</h2>
        <p class="section-subtitle">
          Base offer = Market Stat √ó Buy % √ó Condition Adjustment
        </p>

        <div class="formula-box">
          <div class="formula-step">
            <span class="formula-label">Market Data Source:</span>
            <select style="max-width: 400px">
              <option selected>Hybrid (Average Discogs &amp; eBay)</option>
              <option>Discogs (Primary) ‚Üí eBay (Fallback)</option>
              <option>eBay (Primary) ‚Üí Discogs (Fallback)</option>
              <option>Discogs Only</option>
              <option>eBay Only</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Price Statistic</label>
            <select>
              <option>Low (Lowest sale)</option>
              <option selected>Median (Middle sale)</option>
              <option>High (Highest sale)</option>
            </select>
          </div>
          <div class="form-group">
            <label>Buy Percentage</label>
            <div class="input-with-unit">
              <input type="number" value="55" min="0" max="100" />
              <span class="unit">%</span>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Data Lookback Window</label>
            <select>
              <option>30 days</option>
              <option selected>90 days</option>
              <option>180 days</option>
              <option>1 year</option>
            </select>
          </div>
          <div class="form-group">
            <label>Round to Nearest</label>
            <select>
              <option>$0.01</option>
              <option selected>$0.25</option>
              <option>$0.50</option>
              <option>$1.00</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Minimum Offer (Floor)</label>
            <input type="number" value="5.00" step="0.25" placeholder="$" />
          </div>
          <div class="form-group">
            <label>Maximum Offer (Cap)</label>
            <input type="number" value="500.00" step="0.25" placeholder="$" />
          </div>
        </div>

        <div class="form-group">
          <label>Offer Valid For</label>
          <div class="input-with-unit">
            <input type="number" value="14" min="1" />
            <span class="unit">days</span>
          </div>
        </div>
      </section>

      <section class="policy-section">
        <h2 class="section-title">Sell (List Price) Formula</h2>
        <p class="section-subtitle">
          List price = Market Stat √ó Sell % √ó Condition Adjustment
        </p>

        <div class="formula-box">
          <div class="formula-step">
            <span class="formula-label">Market Data Source:</span>
            <select style="max-width: 400px">
              <option selected>Hybrid (Average Discogs &amp; eBay)</option>
              <option>Discogs (Primary) ‚Üí eBay (Fallback)</option>
              <option>eBay (Primary) ‚Üí Discogs (Fallback)</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Price Statistic</label>
            <select>
              <option>Low</option>
              <option selected>Median</option>
              <option>High</option>
            </select>
          </div>
          <div class="form-group">
            <label>Sell Percentage</label>
            <div class="input-with-unit">
              <input type="number" value="125" min="100" />
              <span class="unit">%</span>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Minimum Profit Margin</label>
            <div class="input-with-unit">
              <input type="number" value="30" min="0" max="100" />
              <span class="unit">%</span>
            </div>
          </div>
          <div class="form-group">
            <label>Round to Nearest</label>
            <select>
              <option>$0.01</option>
              <option selected>$0.25</option>
              <option>$0.50</option>
              <option>$1.00</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Minimum Price (Floor)</label>
            <input type="number" value="10.00" step="0.25" placeholder="$" />
          </div>
          <div class="form-group">
            <label>Maximum Price (Cap)</label>
            <input type="number" value="999.99" step="0.25" placeholder="$" />
          </div>
        </div>

        <div class="markdown-section">
          <h3 class="subsection-title">Markdown Schedule (Optional)</h3>
          <p class="section-subtitle">
            Automatically reduce prices for slow-moving inventory
          </p>

          <div class="form-row">
            <div class="form-group">
              <label>After 30 days unsold, reduce by</label>
              <div class="input-with-unit">
                <input type="number" value="10" min="0" max="100" />
                <span class="unit">%</span>
              </div>
            </div>
            <div class="form-group">
              <label>After 60 days unsold, reduce by</label>
              <div class="input-with-unit">
                <input type="number" value="20" min="0" max="100" />
                <span class="unit">%</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="policy-section">
        <h2 class="section-title">Channel-Specific Adjustments</h2>
        <p class="section-subtitle">
          Apply multipliers to different acquisition channels
        </p>

        <table class="table">
          <thead>
            <tr>
              <th>Channel</th>
              <th style="width: 120px">Buy Multiplier</th>
              <th style="width: 120px">Sell Multiplier</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Web Submission</strong></td>
              <td>
                <input
                  type="number"
                  value="1.0"
                  step="0.05"
                  class="input-small"
                />
              </td>
              <td>
                <input
                  type="number"
                  value="1.0"
                  step="0.05"
                  class="input-small"
                />
              </td>
              <td>Standard rates</td>
            </tr>
            <tr>
              <td><strong>Store Walk-In</strong></td>
              <td>
                <input
                  type="number"
                  value="0.95"
                  step="0.05"
                  class="input-small"
                />
              </td>
              <td>
                <input
                  type="number"
                  value="1.0"
                  step="0.05"
                  class="input-small"
                />
              </td>
              <td>Lower buy offer (no shipping)</td>
            </tr>
            <tr>
              <td><strong>Bulk Collection</strong></td>
              <td>
                <input
                  type="number"
                  value="0.85"
                  step="0.05"
                  class="input-small"
                />
              </td>
              <td>
                <input
                  type="number"
                  value="1.0"
                  step="0.05"
                  class="input-small"
                />
              </td>
              <td>Discount for large lots</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="policy-section">
        <h2 class="section-title">Preview: Example Calculations</h2>
        <p class="section-subtitle">
          How this policy would price a sample album under different conditions
        </p>

        <div class="preview-album">
          <strong>Sample: Dark Side of the Moon by Pink Floyd</strong><br />
          <span class="text-muted"
            >Market Data: Discogs Median $85 | eBay Median $92 | Hybrid Average
            $88.50</span
          >
        </div>

        <table class="table">
          <thead>
            <tr>
              <th>Media / Sleeve</th>
              <th>Buy Offer</th>
              <th>List Price</th>
              <th>Profit Margin</th>
            </tr>
          </thead>
          <tbody>
            <tr style="background: rgba(16, 185, 129, 0.05)">
              <td>
                <strong>Mint / Mint</strong><br /><span class="text-muted"
                  >120% √ó 110%</span
                >
              </td>
              <td><strong>$58.24</strong></td>
              <td><strong>$146.91</strong></td>
              <td>152%</td>
            </tr>
            <tr>
              <td>
                <strong>Near Mint / Near Mint</strong><br /><span
                  class="text-muted"
                  >100% √ó 100%</span
                >
              </td>
              <td><strong>$48.68</strong></td>
              <td><strong>$110.63</strong></td>
              <td>127%</td>
            </tr>
            <tr>
              <td>
                <strong>Very Good / Very Good+</strong><br /><span
                  class="text-muted"
                  >60% √ó 75%</span
                >
              </td>
              <td><strong>$21.91</strong></td>
              <td><strong>$49.78</strong></td>
              <td>127%</td>
            </tr>
            <tr>
              <td>
                <strong>Good / Good</strong><br /><span class="text-muted"
                  >25% √ó 15%</span
                >
              </td>
              <td><strong>$5.86</strong></td>
              <td><strong>$13.28</strong></td>
              <td>127%</td>
            </tr>
          </tbody>
        </table>
      </section>

      <div class="policy-actions">
        <button class="button button--success button--lg">‚úì Save Policy</button>
        <button class="button button--primary button--lg">
          üìã Preview in Queue
        </button>
        <button class="button button--secondary button--lg">
          Reset to Default
        </button>
        <a href="index.html" class="button button--secondary button--lg"
          >‚Üê Cancel</a
        >
      </div>

      <footer class="admin-footer">
        &copy; 2024 Vinyl Catalog ‚Äî Pricing system.
      </footer>
    </main>

    <script src="../../js/api-client.js?v=20251205"></script>
    <script src="../../js/auth.js?v=20251205"></script>
    <script src="../../js/topnav.js?v=20251205"></script>
    <script>
      document.addEventListener('DOMContentLoaded', async function () {
        const isAuthenticated = await auth.verifySession();
        if (!isAuthenticated) {
          window.location.href = '/pages/admin/login.html';
        }

        const logoutBtn = document.querySelector('[data-logout-btn]');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', async (e) => {
            e.preventDefault();
            if (confirm('Sign out of the admin console?')) {
              await auth.logout();
            }
          });
        }
      });
    </script>
  </body>
</html>
